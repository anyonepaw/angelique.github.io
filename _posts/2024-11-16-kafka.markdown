---
layout: post
title:  ":book: Kafka - developer's guideline"
date: 2024-11-16 15:50:34 +0300
categories: develop
tags: pattern
---

- Описание работы
- Выдержки из опыта


![img.png](../assets/images/img.png)

#### **Источники:**


## Гарантии доставки до Apache Kafka


### 1-й уровень - At-most-once:

- Важна производительность и допустимы потери отправленных событий
- Продьюсер отправляет сообщение и не дожидается подтверждения (ack) от брокера

### 2-й уровень - At-least-once (самый популярный):

- Важно, чтобы событие было доставлено, даже если это приведет к дублированию
- Продьюсер дожидается подтверждения (ack) от брокера
- Чтобы обеспечить гарантию (если подтверждение не дошло) - нужны ретраи
- Самому потребителю нужно уметь обрабатывать дубли

### 3-й уровень - Exactly-once:

- критична доставка и недопущение дублирования
- идемпотентный продьюсер (экземпляр, а не кластер) предотвращает дублирование сообщения
- транзакции Kafka гарантируют доставку до нее
- в техническом плане самый сложный уровень, может не гарантироваться на самом брокере
  (Виктор Гамов - один раз в год сады цветут: разбор семантики exactly-once в Kafka)